// Step 1: Load the graph data into Neo4j
LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/Brijeshjadav/Neo4j/main/chat_create_team_chat.csv' AS row
MERGE (n1:Node {id: row.source})
MERGE (n2:Node {id: row.target})
MERGE (n1)-[:CONNECTED_TO]->(n2)

// Step 2: Run the Louvain algorithm for community detection
CALL gds.louvain.write({
  nodeProjection: 'Node',
  relationshipProjection: {
    CONNECTED_TO: {
      type: 'CONNECTED_TO',
      orientation: 'UNDIRECTED'
    }
  },
  writeProperty: 'community'
})

// Step 3: Retrieve the communities and their nodes
MATCH (n:Node)
RETURN n.id, n.community
